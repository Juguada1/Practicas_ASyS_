<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>ASyS Practica 3: Se&ntilde;ales en tiempo continuo</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2023-10-27">
<meta name="DC.source" content="ASySPrac4JuanRuiz.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>ASyS Practica 3: Se&ntilde;ales en tiempo continuo</h1>
<!--introduction-->
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Integrantes</a>
</li>
<li>
<a href="#2">Objetivos de la Practica:</a>
</li>
<li>
<a href="#3">Introduccion</a>
</li>
<li>
<a href="#4">Desarrollo</a>
</li>
<li>
<a href="#5">Problema 1</a>
</li>
<li>
<a href="#6">Analitico Problema 1</a>
</li>
<li>
<a href="#12">Convolucion Matlab</a>
</li>
<li>
<a href="#14">Simulacion Problema 1</a>
</li>
<li>
<a href="#16">Problema 2</a>
</li>
<li>
<a href="#17">Analitico Problema 2</a>
</li>
<li>
<a href="#22">Autocorrelacion MATLAB</a>
</li>
<li>
<a href="#24">Problema 3</a>
</li>
<li>
<a href="#25">C)</a>
</li>
<li>
<a href="#26">D)</a>
</li>
<li>
<a href="#28">Problema 4</a>
</li>
<li>
<a href="#31">Problema 5</a>
</li>
<li>
<a href="#32">C)</a>
</li>
<li>
<a href="#33">D)</a>
</li>
</ul>
</div>
<h2 id="1">Integrantes</h2>
<div>
<ul>
<li>Dorantes Ochoa Daniel</li>
<li>Ruiz Guadarrama Juan Carlos</li>
<li>Santos Garrido Diana Karen</li>
</ul>
</div>
<h2 id="2">Objetivos de la Practica:</h2>
<div>
<ul>
<li>Conocer m&eacute;todos b&aacute;sicos de integraci&oacute;n num&eacute;rica *Manipulaci&oacute;n de instrucciones en MATLAB *Simular convoluciones y correlaciones de se&ntilde;ales continuas *Simular convoluciones y correlaciones de se&ntilde;ales discretas</li>
</ul>
</div>
<h2 id="3">Introduccion</h2>
<p>El equipo investigo como se grafica con Phyton y como evidencia se realizo el Problema 4 A lo que el resultado nos dio:</p>
<h2 id="4">Desarrollo</h2>
<p>Para el desarrollo se tienen que resolver cada uno de los siguientes problemas comenzando una nueva secci&oacute;n (para la publicaci&oacute;n) en cada uno de ellos. Para cada problema se tendr&aacute;n que hacer las mod&iacute;ficaciones necesarias al c&oacute;digo de ejemplo, convendr&iacute;a entonces pensar en realizar una modificaci&oacute;n general de tal manera que el programa funcione para cualquier convolucion dos funciones, pero esto es opcional.</p>
<h2 id="5">Problema 1</h2>
<p>Para el PR04 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la convoluci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema 1, esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de la convoluci&oacute;n, y en esta &uacute;ltima gr&aacute;ficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico.</p>
<h2 id="6">Analitico Problema 1</h2>
<p>Funcion x(t)</p>
<pre class="codeinput">syms <span class="string">t</span>
f= exp(-t).*heaviside(t)-exp(-t).*heaviside(t-1);
r= matlabFunction(f)
t=-3:0.01:3;
plot(t,r(t));
title(<span class="string">'Funcion f(t)'</span>);
xlabel(<span class="string">'t'</span>);
ylabel(<span class="string">'f(t)'</span>)
</pre>
<pre class="codeoutput">
r =

  function_handle with value:

    @(t)exp(-t).*heaviside(t)-heaviside(t-1.0).*exp(-t)

</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_01.png" alt=""> <p>Funcion g(t)</p>
<pre class="codeinput">syms <span class="string">t</span>
y= t.*heaviside(-t)+t.*heaviside(t)-t.*heaviside(-t-1)-t.*heaviside(t-1);
e=matlabFunction(y);
t=-3:0.001:3;
plot(t,e(t));
ax = gca;
ax.XAxisLocation = <span class="string">'origin'</span>;
ax.YAxisLocation = <span class="string">'origin'</span>;
title(<span class="string">'Funcion g(t)'</span>);
xlabel(<span class="string">'t'</span>); ylabel(<span class="string">'g(t)'</span>);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_02.png" alt=""> <p>Convolucion de x(t)*g(t)</p>
<pre class="codeinput">syms <span class="string">t</span> <span class="string">tau</span>
F_rg = int(r(tau)*e(t-tau),tau,0,t);
F_rg=simplify(F_rg,<span class="string">"Steps"</span>,30)
l=matlabFunction(F_rg);
t=-3:0.001:3;
plot(t,l(t));
</pre>
<pre class="codeoutput"> 
F_rg =
 
heaviside(t)*(t + exp(-t) - 1) - heaviside(t - 1)*(exp(-t) - 2*exp(-1) + t*exp(-1)) - heaviside(t - 1)*(t - 1) + heaviside(t - 2)*exp(-1)*(t - 2)
 
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_03.png" alt=""> <h2 id="12">Convolucion Matlab</h2>
<pre class="codeinput">figure
subplot(1,3,1)
syms <span class="string">t</span>
x=piecewise(t&lt;0,0,0&lt;=t&lt;=1,exp(-t),t&gt;1,0);
fplot(x,[-1,3],<span class="string">'r'</span>)
grid <span class="string">on</span>
title(<span class="string">'x(t)'</span>)
axis([-1 3.6 -2 2]);
subplot(1,3,2)
h=piecewise(t&lt;-1,0,-1&lt;t&lt;1,t,1&lt;t,0);
fplot(h,[-3,3],<span class="string">'r'</span>)
grid <span class="string">on</span>
title(<span class="string">'h(t)'</span>)
axis([-3 3 -2 2]);
t1=-3:0.01:0;
t2=0:0.01:1;
t3=1:0.01:2;
t4=2:0.01:3;
subplot(1,3,3)
plot(t1,0)
hold <span class="string">on</span>
plot(t2,(.75).*exp(t2)-1);
plot(t3,-(t3-2))
plot(t4,0)
grid <span class="string">on</span>
title(<span class="string">'x(t)*h(t)'</span>)
axis([-1 3.6 -2 2]);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_04.png" alt=""> <h2 id="14">Simulacion Problema 1</h2>
<pre class="codeinput">h=@(t)  t.*heaviside(-t)+t.*heaviside(t)-t.*heaviside(-t-1)-t.*heaviside(t-1);
x=@(t) exp(-t).*heaviside(t)-exp(-t).*heaviside(t-1);
convconm(x,h);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_05.png" alt=""> <h2 id="16">Problema 2</h2>
<p>Para el PR05 reporte la grafica de la simulaci&oacute;n n&uacute;merica de la correalci&oacute;n y compare con el resultado an&aacute;litico que obtuvo para el problema e), esto es, su pr&aacute;ctica tendr&aacute; que incluir una llamada a la funci&oacute;nn convconm y posteriormente se tendr&aacute; que mostrar (mediante el Publish) la gr&aacute;fica tanto de las se&ntilde;ales involucradas como el resultado de su correlaci&oacute;n, y en esta &uacute;ltima graficara su resultado analitico, se tendr&aacute; que incluir el resultado analitico.</p>
<h2 id="17">Analitico Problema 2</h2>
<p>Funcion Original</p>
<p>x(t)</p>
<pre class="codeinput"> syms <span class="string">t</span>;
 figure;
 x1= heaviside(t)- 2.*heaviside(t-3)+ heaviside(t-4);
 v= matlabFunction(x1);
 t=-3:.01:12;
 plot(t,v(t));
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_06.png" alt=""> <p>x(-t)</p>
<pre class="codeinput"> syms <span class="string">t</span>;
 figure;
 x2= heaviside(-t)- 2.*heaviside(-t-3)+ heaviside(-t-4);
 u= matlabFunction(x2);
 t=-12:.01:3;
 plot(t,u(t));
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_07.png" alt=""> <h2 id="22">Autocorrelacion MATLAB</h2>
<pre class="codeinput">x=@(t) heaviside(t)- 2.*heaviside(t-3)+ heaviside(t-4);
h=@(t) heaviside(-t)- 2.*heaviside(-t-3)+ heaviside(-t-4);
convconm(x,h);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_08.png" alt=""> <h2 id="24">Problema 3</h2>
<p>Realice la simuaci&oacute;n de la convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1</p>
<h2 id="25">C)</h2>
<pre class="codeinput">x = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
n = -3:3;
figure
stem(n,x(n));
title(<span class="string">"Se&ntilde;al x[n]"</span>);
ylabel(<span class="string">"x[n]"</span>); xlabel(<span class="string">"n"</span>);
n=-3:3;
E = sum(x(n).^2)
</pre>
<pre class="codeoutput">
E =

   252

</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_09.png" alt=""> <h2 id="26">D)</h2>
<pre class="codeinput">x = @(n) ((2*n).*heaviside(n)+(-2*n).*heaviside(-n));
n = -2:2;
figure
stem(n,x(n));
title(<span class="string">"Se&ntilde;al y[n]"</span>);
ylabel(<span class="string">"y[n]"</span>); xlabel(<span class="string">"n"</span>);
n=-2:2;
E = sum(x(n).^2);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_10.png" alt=""> <pre class="codeinput">n=0:10;
a=[0 0 -9 -6 -3 0 3 6 9 0 0]
b=[0 0 0 4 2 0 2 4 0 0 0]
convdisc([n;a],[n;b]);
</pre>
<pre class="codeoutput">
a =

     0     0    -9    -6    -3     0     3     6     9     0     0


b =

     0     0     0     4     2     0     2     4     0     0     0

</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_11.png" alt=""> <img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_12.png" alt=""> <h2 id="28">Problema 4</h2>
<p>Realice la simuaci&oacute;n de la correlaci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1</p>
<p>Usando la funcion Convdisc nos da:</p>
<pre class="codeinput">a2 = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
a21=-3:3;
b2 = @(n) ((2*-n).*heaviside(-n)+(-2*-n).*heaviside(+n));
b21= -2:2;
convdisc([a21;a2(a21)],[b21;b2(b21)]);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_13.png" alt=""> <h2 id="31">Problema 5</h2>
<p>Realice la la convoluci&oacute;n de las se&ntilde;ales (c) con (d) del problema 3.1.1 utilizando el comando conv de MATLAB, muestre el c&oacute;digo utilizado y gr&aacute;fique el resultado, sugerencia: Utilice las propiedades de traslaci&oacute;n de la convoluci&oacute;n.</p>
<h2 id="32">C)</h2>
<pre class="codeinput">x = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
n = -3:3;
figure
stem(n,x(n));
n=-3:3;
E = sum(x(n).^2)
</pre>
<pre class="codeoutput">
E =

   252

</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_14.png" alt=""> <h2 id="33">D)</h2>
<pre class="codeinput">y = @(n) ((2*n).*heaviside(n)+(-2*n).*heaviside(-n));
n = -2:2;
figure
stem(n,y(n));
n=-2:2;
E = sum(y(n).^2);
</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_15.png" alt=""> <pre class="codeinput">n=-10:10;
a=[0 0 -9 -6 -3 0 3 6 9 0 0]
b=[0 0 0 4 2 0 2 4 0 0 0]
C=conv(a,b);
figure
subplot(1,1,1)
stem(n,C);
title(<span class="string">"Convolucion de se&ntilde;ales x[n]*y[n]"</span>);
ylabel(<span class="string">"x[n]*y[n]"</span>); xlabel(<span class="string">"n"</span>);
</pre>
<pre class="codeoutput">
a =

     0     0    -9    -6    -3     0     3     6     9     0     0


b =

     0     0     0     4     2     0     2     4     0     0     0

</pre>
<img vspace="5" hspace="5" src="ASySPrac4JuanRuiz_16.png" alt=""> <pre class="codeinput">
<span class="keyword">function</span> convdisc(x1,x2)
    Tam1 = size(x1(1,:));
    Tam2 = size(x2(1,:));
    T1 = Tam1(2);
    T2 = Tam2(2);
    T3 = T1+T2-1;
    vec1 = zeros(1,T1+2*T2-2);
    vec2 = zeros(1,T1+2*T2-2);
    Tec2 = -(T2-1):(T1+T2-2);
    size(vec2);
    size(Tec2);
    x3=zeros(2,T3);
    x3(1,:)=0:T3-1;
    x3(1,:)=x3(1,:)+x1(1,1)+x2(1,1);
    vec1(1,T2:T2+T1-1)=x1(2,:);
    figure (1)
    hFig = figure(1);
    set(hFig, <span class="string">'Position'</span>, [0 0 1000 1000])
    filename = <span class="string">'testAnimated.gif'</span>;
    ttt=1;
    <span class="keyword">for</span> m=0:T1+T2-2
        vec2(1,1+m:T2+m)=fliplr(x2(2,:));
        x3(2,m+1)=sum(vec1.*vec2);
        subplot(4,1,4)
        stem(x3(1,:),x3(2,:),<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,3)
        axis([Tec2(1),T1+2*T2-2,  min(x3(2,:))-1 max(x3(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        ylabel(<span class="string">'x_3[n]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'n'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        subplot(4,1,1)
        stem(x2(1,:),x2(2,:),<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,3)
        ylabel(<span class="string">'x_2[m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        title(<span class="string">'CONVOLUCI&oacute;N'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        axis([Tec2(1),T1+2*T2-2, min(x2(2,:))-1 max(x2(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        subplot(4,1,2)
        stem(x1(1,:),x1(2,:),<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,3)
        ylabel(<span class="string">'x_1[m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        axis([Tec2(1),T1+2*T2-2, min(x1(2,:))-1 max(x1(2,:))+1])
        ylim(<span class="string">'auto'</span>)
        subplot(4,1,3)
        stem(Tec2,vec2(1,:),<span class="string">'g'</span>,<span class="string">'LineWidth'</span>,3)
        axis([Tec2(1),T1+2*T2-2,min(vec2)-1, max(vec2)+1 ])
        ylim(<span class="string">'auto'</span>)
        ylabel(<span class="string">'x_2[n-m]'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        xlabel(<span class="string">'m'</span>,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="string">'FontSize'</span>,16);
        grid <span class="string">on</span>
        drawnow;
        pause(0.4)
        vec2 = zeros(1,T1+2*T2-2);
        frame = getframe(hFig);
        im = frame2im(frame);
        [imind,cm] = rgb2ind(im,256);
        <span class="comment">% Write to the GIF File</span>
        <span class="keyword">if</span> ttt == 1
          imwrite(imind,cm,filename,<span class="string">'gif'</span>, <span class="string">'Loopcount'</span>,inf);
        <span class="keyword">else</span>
          imwrite(imind,cm,filename,<span class="string">'gif'</span>,<span class="string">'WriteMode'</span>,<span class="string">'append'</span>);
        <span class="keyword">end</span>
        ttt=ttt+1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre>
<pre class="codeinput">  <span class="keyword">function</span> convconm(x,h)
  figure (1) <span class="comment">% Se crea una figura para hacer las gr&aacute;ficas</span>
  dtau = 0.005; <span class="comment">% Base de los rectangulos para realizar la integral</span>
  tau = -1:dtau:4; <span class="comment">% Intervalo de visualizaci&oacute;n del resultado</span>
  ti = 0; <span class="comment">% Indice para el vector de resultados</span>
  tvec = -.25:.1:3.75; <span class="comment">% traslaciones de t, cuantas integrales se calulan</span>
  y = NaN*zeros(1, length (tvec)); <span class="comment">% Resultados de acuerdo a cuantos t</span>
  <span class="keyword">for</span> t = tvec, <span class="comment">% Cantidad de traslaciones</span>
      ti = ti+1; <span class="comment">% Indice para guardar el resultado (indice del tiempo)</span>
      xh = x(t-tau).*h(tau); <span class="comment">% resultado de la multiplicaci&oacute;n</span>
      lxh = length(xh); <span class="comment">% longitud del resultado</span>
      y(ti) = sum(xh.*dtau); <span class="comment">% Base por altura, aproximaci&oacute;n de la integral</span>
      subplot (2,1,1), <span class="comment">% gr&aacute;fica de 2 x 1 (primera)</span>
      plot(tau, h(tau), <span class="string">'r-'</span>, tau, x(t-tau), <span class="string">'g--'</span>, t, 0, <span class="string">'ob'</span>); <span class="comment">%graficas</span>
      axis ([tau(1) tau(end) -2.0 2.5]); <span class="comment">% l&iacute;mites de los ejes</span>
      patch([tau(1:end-1); tau(1:end-1); tau(2:end); tau(2:end)],<span class="keyword">...</span>
      [zeros(1,lxh-1);xh(1:end-1);xh(2:end);zeros(1,lxh-1)],<span class="keyword">...</span>
      [.8 .8 .8], <span class="string">'edgecolor'</span>, <span class="string">'none'</span>);
      xlabel(<span class="string">'\tau'</span>); <span class="comment">% Texto del eje X</span>
      legend(<span class="string">'h(\tau)'</span>, <span class="string">'x(t-\tau)'</span>,<span class="string">'t'</span>,<span class="string">'h(\tau)x(t-\tau)'</span>)<span class="comment">% Caja de Texto</span>
      subplot (2, 1, 2)  <span class="comment">% gr&aacute;fica de 2 x 1 (segunda)</span>
      plot (tvec, y, <span class="string">'k'</span>, tvec (ti), y(ti), <span class="string">'ok'</span>);
      xlabel (<span class="string">'t'</span>);
      ylabel (<span class="string">'y(t) = \int h(\tau)x(t-\tau) d\tau'</span>);
      axis ([tau(1) tau(end) -1.0 2.0]); <span class="comment">% l&iacute;mites del eje</span>
      grid; <span class="comment">% malla</span>
      drawnow; <span class="comment">% efecto de movimiento continuo</span>
  <span class="keyword">end</span>
  <span class="keyword">end</span>
</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% ASyS Practica 3: Señales en tiempo continuo
%
%% Integrantes
% * Dorantes Ochoa Daniel
% * Ruiz Guadarrama Juan Carlos
% * Santos Garrido Diana Karen
%
%% Objetivos de la Practica:
%
% * Conocer métodos básicos de integración numérica
% *Manipulación de instrucciones en MATLAB
% *Simular convoluciones y correlaciones de señales continuas
% *Simular convoluciones y correlaciones de señales discretas
%
%% Introduccion 
% El equipo investigo como se grafica con Phyton y como evidencia se
% realizo el Problema 4 
% A lo que el resultado nos dio:
%% Desarrollo
% Para el desarrollo se tienen que resolver cada uno de los siguientes problemas comenzando una nueva sección (para la publicación) en cada uno de ellos.
% Para cada problema se tendrán que hacer las modíficaciones necesarias al código de ejemplo, convendría entonces pensar en realizar una modificación general de tal manera que 
% el programa funcione para cualquier convolucion dos funciones, pero esto es opcional.
%% Problema 1
% Para el PR04 reporte la grafica de la simulación númerica de la convolución y compare con el resultado análitico que obtuvo para el problema 1,
% esto es, su práctica tendrá que incluir una llamada a la funciónn convconm y posteriormente se tendrá que mostrar (mediante el Publish) la gráfica tanto de las señales 
% involucradas como el resultado de la convolución, y en esta última gráficara su resultado analitico, se tendrá que incluir el resultado analitico.
%% Analitico Problema 1
% Funcion x(t)
%%
syms t
f= exp(-t).*heaviside(t)-exp(-t).*heaviside(t-1);
r= matlabFunction(f)  
t=-3:0.01:3;
plot(t,r(t));
title('Funcion f(t)');
xlabel('t');
ylabel('f(t)')
%%
% Funcion g(t)
%% 
syms t
y= t.*heaviside(-t)+t.*heaviside(t)-t.*heaviside(-t-1)-t.*heaviside(t-1);
e=matlabFunction(y);
t=-3:0.001:3;
plot(t,e(t));
ax = gca;
ax.XAxisLocation = 'origin';
ax.YAxisLocation = 'origin';
title('Funcion g(t)');
xlabel('t'); ylabel('g(t)');
%% 
% Convolucion de x(t)*g(t)
%% 
syms t tau
F_rg = int(r(tau)*e(t-tau),tau,0,t);
F_rg=simplify(F_rg,"Steps",30)
l=matlabFunction(F_rg);
t=-3:0.001:3;
plot(t,l(t));
%% Convolucion Matlab
%% 
figure
subplot(1,3,1)
syms t
x=piecewise(t<0,0,0<=t<=1,exp(-t),t>1,0);
fplot(x,[-1,3],'r')
grid on
title('x(t)')
axis([-1 3.6 -2 2]);
subplot(1,3,2)
h=piecewise(t<-1,0,-1<t<1,t,1<t,0);
fplot(h,[-3,3],'r')
grid on
title('h(t)')
axis([-3 3 -2 2]);
t1=-3:0.01:0;
t2=0:0.01:1;
t3=1:0.01:2;
t4=2:0.01:3;
subplot(1,3,3)
plot(t1,0)
hold on
plot(t2,(.75).*exp(t2)-1);
plot(t3,-(t3-2))
plot(t4,0)
grid on
title('x(t)*h(t)')
axis([-1 3.6 -2 2]);
%% Simulacion Problema 1
%% 
h=@(t)  t.*heaviside(-t)+t.*heaviside(t)-t.*heaviside(-t-1)-t.*heaviside(t-1);
x=@(t) exp(-t).*heaviside(t)-exp(-t).*heaviside(t-1);
convconm(x,h);
%% Problema 2
% Para el PR05 reporte la grafica de la simulación númerica de la correalción y compare con el resultado análitico que obtuvo 
% para el problema e), esto es, su práctica tendrá que incluir una llamada a la funciónn convconm y posteriormente se tendrá que mostrar (mediante el Publish) 
% la gráfica tanto de las señales involucradas como el resultado de su correlación, y en esta última graficara su resultado analitico, se tendrá que incluir 
% el resultado analitico.
%% Analitico Problema 2
 % Funcion Original
 %% 
 % x(t)
 %%
 syms t;
 figure;
 x1= heaviside(t)- 2.*heaviside(t-3)+ heaviside(t-4);
 v= matlabFunction(x1); 
 t=-3:.01:12;
 plot(t,v(t));
 %%
 % x(-t)
 %%
 syms t;
 figure;
 x2= heaviside(-t)- 2.*heaviside(-t-3)+ heaviside(-t-4);
 u= matlabFunction(x2); 
 t=-12:.01:3;
 plot(t,u(t));
%% Autocorrelacion MATLAB
%%
x=@(t) heaviside(t)- 2.*heaviside(t-3)+ heaviside(t-4);
h=@(t) heaviside(-t)- 2.*heaviside(-t-3)+ heaviside(-t-4);
convconm(x,h);
%% Problema 3
% Realice la simuación de la convolución de las señales (c) con (d) del problema 3.1.1
%% C)
x = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
n = -3:3;
figure
stem(n,x(n));
title("Señal x[n]");
ylabel("x[n]"); xlabel("n");
n=-3:3;
E = sum(x(n).^2)
%% D)
x = @(n) ((2*n).*heaviside(n)+(-2*n).*heaviside(-n));
n = -2:2;
figure
stem(n,x(n));
title("Señal y[n]");
ylabel("y[n]"); xlabel("n");
n=-2:2;
E = sum(x(n).^2);
%% 
n=0:10;
a=[0 0 -9 -6 -3 0 3 6 9 0 0]
b=[0 0 0 4 2 0 2 4 0 0 0]
convdisc([n;a],[n;b]);
%% Problema 4
% Realice la simuación de la correlación de las señales (c) 
% con (d) del problema 3.1.1
%%
% Usando la funcion Convdisc nos da:
%%
a2 = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
a21=-3:3;
b2 = @(n) ((2*-n).*heaviside(-n)+(-2*-n).*heaviside(+n));
b21= -2:2;
convdisc([a21;a2(a21)],[b21;b2(b21)]);
%% Problema 5
% Realice la la convolución de las señales (c) con (d) del problema 3.1.1 
% utilizando el comando conv de MATLAB, muestre el código utilizado y 
% gráfique el resultado, sugerencia: Utilice las propiedades de traslación 
% de la convolución.
%% C)
x = @(n) ((3*n).*heaviside(n)+(3*n).*heaviside(-n));
n = -3:3;
figure
stem(n,x(n));
n=-3:3;
E = sum(x(n).^2)
%% D)
y = @(n) ((2*n).*heaviside(n)+(-2*n).*heaviside(-n));
n = -2:2;
figure
stem(n,y(n));
n=-2:2;
E = sum(y(n).^2);
%% 
n=-10:10;
a=[0 0 -9 -6 -3 0 3 6 9 0 0]
b=[0 0 0 4 2 0 2 4 0 0 0]
C=conv(a,b);
figure
subplot(1,1,1)
stem(n,C);
title("Convolucion de señales x[n]*y[n]");
ylabel("x[n]*y[n]"); xlabel("n");
%% 
function convdisc(x1,x2)
    Tam1 = size(x1(1,:));
    Tam2 = size(x2(1,:));
    T1 = Tam1(2);
    T2 = Tam2(2);
    T3 = T1+T2-1;
    vec1 = zeros(1,T1+2*T2-2);
    vec2 = zeros(1,T1+2*T2-2);
    Tec2 = -(T2-1):(T1+T2-2);
    size(vec2);
    size(Tec2);
    x3=zeros(2,T3);
    x3(1,:)=0:T3-1;
    x3(1,:)=x3(1,:)+x1(1,1)+x2(1,1);
    vec1(1,T2:T2+T1-1)=x1(2,:);
    figure (1)
    hFig = figure(1);
    set(hFig, 'Position', [0 0 1000 1000])
    filename = 'testAnimated.gif';
    ttt=1;
    for m=0:T1+T2-2
        vec2(1,1+m:T2+m)=fliplr(x2(2,:));
        x3(2,m+1)=sum(vec1.*vec2);
        subplot(4,1,4)
        stem(x3(1,:),x3(2,:),'r','LineWidth',3)
        axis([Tec2(1),T1+2*T2-2,  min(x3(2,:))-1 max(x3(2,:))+1])
        ylim('auto')
        ylabel('x_3[n]','FontWeight','bold','FontSize',16);
        xlabel('n','FontWeight','bold','FontSize',16);
        grid on
        subplot(4,1,1)
        stem(x2(1,:),x2(2,:),'k','LineWidth',3)
        ylabel('x_2[m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        title('CONVOLUCIóN','FontWeight','bold','FontSize',16);
        grid on
        axis([Tec2(1),T1+2*T2-2, min(x2(2,:))-1 max(x2(2,:))+1])
        ylim('auto')
        subplot(4,1,2)
        stem(x1(1,:),x1(2,:),'b','LineWidth',3)
        ylabel('x_1[m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        grid on
        axis([Tec2(1),T1+2*T2-2, min(x1(2,:))-1 max(x1(2,:))+1])
        ylim('auto')
        subplot(4,1,3)
        stem(Tec2,vec2(1,:),'g','LineWidth',3)
        axis([Tec2(1),T1+2*T2-2,min(vec2)-1, max(vec2)+1 ])
        ylim('auto')
        ylabel('x_2[n-m]','FontWeight','bold','FontSize',16);
        xlabel('m','FontWeight','bold','FontSize',16);
        grid on
        drawnow;
        pause(0.4)
        vec2 = zeros(1,T1+2*T2-2);
        frame = getframe(hFig); 
        im = frame2im(frame); 
        [imind,cm] = rgb2ind(im,256); 
        % Write to the GIF File 
        if ttt == 1 
          imwrite(imind,cm,filename,'gif', 'Loopcount',inf); 
        else 
          imwrite(imind,cm,filename,'gif','WriteMode','append'); 
        end
        ttt=ttt+1;
    end
end
 %%
  function convconm(x,h)
  figure (1) % Se crea una figura para hacer las gráficas
  dtau = 0.005; % Base de los rectangulos para realizar la integral 
  tau = -1:dtau:4; % Intervalo de visualización del resultado
  ti = 0; % Indice para el vector de resultados
  tvec = -.25:.1:3.75; % traslaciones de t, cuantas integrales se calulan  
  y = NaN*zeros(1, length (tvec)); % Resultados de acuerdo a cuantos t
  for t = tvec, % Cantidad de traslaciones
      ti = ti+1; % Indice para guardar el resultado (indice del tiempo)
      xh = x(t-tau).*h(tau); % resultado de la multiplicación 
      lxh = length(xh); % longitud del resultado
      y(ti) = sum(xh.*dtau); % Base por altura, aproximación de la integral
      subplot (2,1,1), % gráfica de 2 x 1 (primera)
      plot(tau, h(tau), 'r-', tau, x(t-tau), 'gREPLACE_WITH_DASH_DASH', t, 0, 'ob'); %graficas 
      axis ([tau(1) tau(end) -2.0 2.5]); % límites de los ejes
      patch([tau(1:end-1); tau(1:end-1); tau(2:end); tau(2:end)],...
      [zeros(1,lxh-1);xh(1:end-1);xh(2:end);zeros(1,lxh-1)],...
      [.8 .8 .8], 'edgecolor', 'none');
      xlabel('\tau'); % Texto del eje X
      legend('h(\tau)', 'x(t-\tau)','t','h(\tau)x(t-\tau)')% Caja de Texto  
      subplot (2, 1, 2)  % gráfica de 2 x 1 (segunda)
      plot (tvec, y, 'k', tvec (ti), y(ti), 'ok');
      xlabel ('t'); 
      ylabel ('y(t) = \int h(\tau)x(t-\tau) d\tau');
      axis ([tau(1) tau(end) -1.0 2.0]); % límites del eje
      grid; % malla
      drawnow; % efecto de movimiento continuo
  end
  end
##### SOURCE END #####
-->
</body>
</html>
